import numpy as np
import lattice_elasticity as le
import matplotlib.pyplot as plt


xy = np.array([[2.724217488627969974e+00,-2.976435584746583984e+00],  [2.182848335803861950e+00,-3.402075703300047049e+00],
    [-3.923444200157479855e+00,-3.463796855120466756e+00],            [2.113057428073286115e+00,4.546926452878380154e+00],
    [2.302451831394968895e+00,3.490762764967130671e+00],              [9.697986117896510994e-01,-3.680146892264366532e-01],
    [-2.632633090042079349e+00,3.755965455515874130e+00],             [-5.086571399355268586e-01,6.176592495147481543e-02],
    [2.340939735579837810e-01,-6.588685300757304297e-01],             [2.022524068028572763e-01,-9.540877874370963241e-01],
    [-5.267915673742963323e-01,-1.981063128598679501e+00],            [-2.190395732290378206e+00,1.471025339312911573e+00],
    [-4.341400345873249300e+00,3.233124827116466093e+00],             [-3.318352638435415169e+00,3.265408160648248792e+00],
    [5.851094832679919477e-01,4.140675320548108829e+00],              [7.433178188089029081e-01,2.955629726028079940e+00],
    [3.962228141441888063e-01,3.616045069395356748e+00],              [-8.943742198507069752e-01,1.064360364521021785e+00],
    [-1.624627391735278481e+00,1.525904473532839534e+00],             [-1.414243508313497877e+00,3.590822289317727289e+00],
    [-1.321956425073613328e+00,3.677056133764459389e+00],             [1.614826379443214721e+00,1.007009093094507257e+00],
    [7.617299309174689892e-01,2.462751656633878738e+00],              [7.693535981790642353e-01,2.483824209870186372e+00],
    [3.032298585035444027e+00,-2.124173860105345479e+00],             [1.927324360676074599e+00,-5.527197521114308731e-01],
    [-2.350816308380943020e+00,-8.412532752668633318e-01],            [-3.053078481905877162e+00,-2.697928957418050278e+00],
    [-1.945781306887151674e+00,-2.795800978086940169e+00]])

polygon = np.array([[-5.,-5.],[-5.,5.],[5.,5.],[5.,-5.]])
xy,NL,KL,BL,BM = le.delaunay_centroid_lattice_from_pts(xy, polygon = polygon, check=False)
le.display_lattice_2D(xy,BL,close=False, colorpoly=True, viewmethod=False)